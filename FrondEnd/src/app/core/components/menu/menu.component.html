<!-- HEADER -->
<div
  class="px-6 py-4 flex items-center bg-green-900 shadow-lg sticky top-0 z-40 border-b border-blue-200"
  style="font-family: 'Times New Roman', Times, serif"
>
  <img
    src="escudo.jpg"
    alt="logo"
    class="w-20 h-20 object-contain rounded-full border-2 border-blue-200 shadow-md bg-white"
  />

  <nav
    class="flex flex-1 ml-6 gap-8 text-white font-semibold text-lg select-none cursor-pointer flex-wrap items-center"
  >
    <!-- Enlaces públicos -->
    <div
      routerLink="/home"
      id="home-link"
      class="pb-1 border-b-2 border-transparent hover:border-blue-300 hover:text-blue-200 transition"
    >
      Home
    </div>

    <div
      routerLink="/cont"
      id="quienes-somos-link"
      class="pb-1 border-b-2 border-transparent hover:border-blue-300 hover:text-blue-200 transition"
    >
      Quienes Somos
    </div>

    <!-- Procesos dinámicos -->
    <ng-container *ngIf="authService.isLoggedIn()">
      <ng-container *ngIf="procesosDisponibles.length; else sinProcesos">
        <div
          *ngFor="let proceso of procesosDisponibles"
          [routerLink]="proceso.enlace"
          class="pb-1 border-b-2 border-transparent hover:border-blue-300 hover:text-blue-200 transition"
        >
          {{ proceso.nombre }}
        </div>
      </ng-container>

      <ng-template #sinProcesos>
        <div class="text-blue-200 italic text-sm">
          No tienes procesos asignados.
        </div>
      </ng-template>
    </ng-container>

    <!-- Select Roles -->
    <select
      *ngIf="authService.isLoggedIn()"
      name="roles"
      id="roles"
      class="ml-auto min-w-[170px] bg-green-800 text-white rounded-xl px-3 py-1.5 border border-blue-200/40 shadow-sm hover:bg-green-700 focus:ring-2 focus:ring-blue-300 outline-none transition"
      [ngModel]="selectedRole"
      [compareWith]="compararRoles"
      (ngModelChange)="selectRole($event)"
    >
      <option *ngFor="let rol of login?.roles" [ngValue]="rol">
        {{ rol.nombre }}
      </option>
    </select>
  </nav>
</div>

<!-- FOOTER -->
<div
  class="bg-green-900 fixed bottom-0 w-full flex justify-between items-center px-6 py-4 shadow-inner border-t border-blue-200"
  style="font-family: 'Times New Roman', Times, serif"
>
  <!-- Usuario -->
  <div>
    <span class="text-white font-semibold">
      <ng-container *ngIf="!authService.isLoggedIn()">
        Usuario: Invitado
      </ng-container>
      <ng-container *ngIf="authService.isLoggedIn()">
        Usuario: {{ login?.nombre }}
      </ng-container>
    </span>
  </div>

  <!-- Autor -->
  <div>
    <span class="text-sm text-blue-200">Abraham Ortega Choque</span>
  </div>

  <!-- Fecha y botones -->
  <div class="flex items-center gap-4">
    <span class="text-white/90 text-sm">
      <ng-container *ngIf="!login">
        {{ fechaActual | date : "EEEE, d 'de' MMMM 'de' y" }}
      </ng-container>
      <ng-container *ngIf="login">
        {{ login.fecha | date : "EEEE, d 'de' MMMM 'de' y" }}
      </ng-container>
    </span>

    <button
      *ngIf="!authService.isLoggedIn()"
      class="bg-blue-100 text-green-900 px-3 py-1.5 rounded-lg text-sm font-semibold shadow hover:bg-blue-200 focus:ring-2 focus:ring-blue-300 transition"
      (click)="openModal()"
    >
      Conectar Usuario
    </button>

    <button
      *ngIf="authService.isLoggedIn()"
      class="bg-white/10 border border-blue-200/40 text-white px-3 py-1.5 rounded-lg text-sm font-semibold hover:bg-white/20 focus:ring-2 focus:ring-blue-300 transition"
      (click)="logout()"
    >
      Desconectar Usuario
    </button>
  </div>
</div>

<!-- MODAL LOGIN -->
<div
  *ngIf="modalOpen"
  class="fixed inset-0 z-50"
  style="font-family: 'Times New Roman', Times, serif"
>
  <div class="absolute inset-0 bg-black/60 backdrop-blur-sm"></div>

  <div class="relative min-h-full flex items-center justify-center p-4">
    <form
      class="w-full max-w-md bg-green-900 text-white rounded-3xl shadow-xl p-7 border border-blue-200"
      (ngSubmit)="ingreso_sistema()"
    >
      <div class="flex justify-between items-center mb-5">
        <h4 class="text-xl font-bold tracking-wide text-blue-200">
          INICIAR SESIÓN
        </h4>
        <button
          type="button"
          class="text-white/70 hover:text-white transition"
          (click)="cancelar()"
        >
          ✕
        </button>
      </div>

      <div class="mb-4">
        <label class="block mb-1 font-semibold">Usuario</label>
        <input
          type="text"
          [(ngModel)]="usuario"
          name="usuario"
          class="w-full px-3 py-2 rounded-lg border border-blue-200/40 bg-green-800 text-white placeholder-white/60 focus:ring-2 focus:ring-blue-300 outline-none transition"
          required
          placeholder="Ingresa tu usuario"
        />
      </div>

      <div class="mb-6">
        <label class="block mb-1 font-semibold">Password</label>
        <input
          type="password"
          [(ngModel)]="password"
          name="password"
          class="w-full px-3 py-2 rounded-lg border border-blue-200/40 bg-green-800 text-white placeholder-white/60 focus:ring-2 focus:ring-blue-300 outline-none transition"
          required
          placeholder="••••••••"
        />
      </div>

      <div class="flex gap-3">
        <button
          type="submit"
          class="flex-1 bg-blue-300 text-green-900 font-bold px-4 py-2 rounded-lg shadow hover:bg-blue-200 transition"
        >
          Ingresar
        </button>

        <button
          type="button"
          class="border border-blue-200/40 px-4 py-2 rounded-lg text-white hover:bg-white/10 transition"
          (click)="cancelar()"
        >
          Cancelar
        </button>
      </div>
    </form>
  </div>
</div>
